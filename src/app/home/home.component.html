<div class="game-container">
  <div class="md:mt-2 md:px-6 score-rows-wrapper">
    <div class="score-rows-inner">
      <ng-container *ngFor="let row of rows; let i = index">
        <div
          class="score-row flex flex-nowrap md:grid md:grid-cols-12 md:grid-rows-1 gap-x-1 p-1 row-height w-full items-center md:place-items-center"
          [ngClass]="{
            'md:rounded-t-md': i === 0,
            'md:rounded-b-md': i === 2
          }" [class]="rowColors[i]">
          <div *ngFor="let space of spaces" class="flex-shrink-0 score-cell md:col-span-1 md:w-auto">
            <app-score-area [isBlank]="row.blankSpots.includes(space)" [isPentagon]="row.pentagons.includes(space)"
              [scorecard]="scorecard" [rowNumber]="i" [colNumber]="space" (updateScorecard)="updateScorecard($event)"
              [selectedScore]="scorecard[i][space]" [backgroundColor]="rowColors[i].split('-')[1]"></app-score-area>
          </div>
        </div>
      </ng-container>
    </div>
  </div>

  <div class="flex justify-center items-center w-full failed-throws-height my-[2vh] p-1 flex-wrap gap-4">
    <div *ngFor="let space of failedThrows; index as i" (click)="markFailedThrow(i)"
      class="failed-throw-box col-span-1 border-2 border-red-600 bg-red-200 text-red-600 rounded-md">
      <div *ngIf="failedThrows[i].marked" class="flex items-center justify-center text-3xl md:text-6xl h-full w-full">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="#dc2625"
          class="w-8 h-8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </div>
    </div>
  </div>

  <div
    class="flex w-full justify-between items-center px-3 md:px-6 min-h-[80px] py-4 flex-wrap gap-4 border-t-2 border-gray-200">
    <div class="flex justify-start items-center h-full">
      <div class="flex flex-row h-full items-center gap-2" (click)="resetGame()">
        <div
          class="col-span-1 bottom-control-element bg-gray-700 rounded-full flex items-center justify-center cursor-pointer">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="white"
            class="h-3/5 aspect-square">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
          </svg>
        </div>
      </div>
      <div class="flex flex-row h-full items-center ml-2" (click)="openSettingsModal()">
        <div
          class="col-span-1 bottom-control-element bg-gray-700 rounded-full flex items-center justify-center cursor-pointer p-[3px]">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="white"
            class="w-full h-full">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        </div>
      </div>
      <div class="flex flex-row h-full items-center" *ngIf="selections.length">
        <div
          class="col-span-1 bottom-control-element border-2 dark:border-none border-black ml-3 rounded-md flex items-center justify-center relative cursor-pointer"
          (click)="undoSelection()"
          [class]="lightBackgrounds[selections[selections.length - 1].row] + ' ' + textColors[selections[selections.length - 1].row]">
          <span>{{ selections[selections.length - 1].value }}</span>
          <div
            class="h-[50%] aspect-square bg-white rounded-full absolute -top-2 -right-2 flex items-center justify-center border-2 border-black">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="black"
              class="h-4/5 aspect-square">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3" />
            </svg>
          </div>
        </div>
      </div>
    </div>

    <div class="flex justify-end items-center h-full min-w-0 flex-wrap gap-x-2 gap-y-2">
      <!-- Row Scores Group -->
      <div class="flex flex-row items-center gap-x-1">
        <div class="flex flex-row h-full items-center">
          <div class="col-span-1 bottom-control-element border-2 mr-1 rounded-full flex items-center justify-center"
            [class]="outlineColors[0]">
            <span *ngIf="!hideScores(); else hiddenScore">{{ rowScores[0] }}</span>
          </div>
          <div class="col-span-1 bottom-control-element border-2 mr-1 rounded-full flex items-center justify-center"
            [class]="outlineColors[1]">
            <span *ngIf="!hideScores(); else hiddenScore">{{ rowScores[1] }}</span>
          </div>
          <div class="col-span-1 bottom-control-element border-2 mr-1 rounded-full flex items-center justify-center"
            [class]="outlineColors[2]">
            <span *ngIf="!hideScores(); else hiddenScore">{{ rowScores[2] }}</span>
          </div>
        </div>
        <span class="text-xl px-1">+</span>
      </div>

      <!-- Bonuses Group -->
      <div class="flex flex-row items-center gap-x-1">
        <div class="flex flex-row h-full items-center">
          <ng-container *ngFor="let bonus of bonuses">
            <div
              class="col-span-1 bottom-control-element border-2 border-gray-400 mr-1 flex justify-center items-center rounded-md">
              <span *ngIf="!hideScores(); else hiddenScore">{{ bonus.value }}</span>
            </div>
          </ng-container>
        </div>
        <span class="text-2xl px-1">-</span>
      </div>

      <!-- Negative Group -->
      <div class="flex flex-row items-center gap-x-1">
        <div
          class="col-span-1 bottom-control-element border-2 border-red-600 mr-1 flex justify-center items-center rounded-md">
          <span *ngIf="!hideScores(); else hiddenScore">{{ negative }}</span>
        </div>
        <span class="text-xl px-1">=</span>
      </div>

      <!-- Total Score -->
      <div
        class="col-span-1 bottom-control-element border-2 border-gray-400 mr-1 flex justify-center items-center rounded-md cursor-pointer"
        (click)="toggleHiddenScores()">
        <span *ngIf="!hideScores(); else hiddenScore">{{ calcTotalScore() }}</span>
      </div>
    </div>
  </div>

  <ng-template #hiddenScore>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
      class="w-2/3">
      <path stroke-linecap="round" stroke-linejoin="round"
        d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />
    </svg>
  </ng-template>
</div>